<!DOCTYPE html>

<!---version 2.9--->
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="Pablo Panitta" name="author"/>
<title>Efecto de Batido en Se√±ales Sub Nyquist - Versi√≥n 2.7</title>
<style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0 auto;
            max-width: 1300px;
            padding: 10px;
            font-size: 20px;
        }

       .titu {
        font-size:36px;
        font-family:Verdana, sans-serif;
        text-align:center;

        }
        h1 {
            font-size: 24px;
            margin-top: 20px;
        }
        h2 {
            font-size: 20px;
            margin-top: 15px;
        }
        p {
            margin: 10px 0;
        }
        .figure {
            text-align: center;
            margin: 20px 0;
            margin-left: 0;
            font-style: italic;
        }
        .figure img {
            max-width: 100%;
            height: auto;
        }
        .figure p {
            margin-top: 5px;
        }
        .equation-left {
            text-align: left;
            font-style: italic;    
            margin-left: 0;
        }
        .equation-center {
            text-align: center;
            font-style: italic;
            margin: 15px 0;
        }
        strong {
            font-weight: bold;
        }
        em {
            font-style: italic;
        }
        ul {
            margin: 10px 0 10px 20px;
        }
        st {
            font-style: italic;
            font-size: 16px;
        }
        .speaker-button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 22px;
            padding: 5px;
        }
        .speaker-button:hover {
            opacity: 0.7;
        }
        .speaker-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

      .button-container {
      display: flex;
      justify-content: center; /* Centra los botones horizontalmente */
      gap: 40px; /* Separaci√≥n de 20px entre los botones */
      margin: 20px 0; /* Espacio vertical opcional arriba y abajo */
      }


    
.tooltip {
    position: relative;
    cursor: pointer;
    text-decoration: none;
}

.tooltip::after {
    content: attr(data-tooltip);
    position: absolute;
    left: 100%;
    top: 0;
    white-space: pre-wrap;
    background-color: #eee;
    color: #000;
    padding: 6px 8px;
    border-radius: 5px;
    box-shadow: 0 0 6px rgba(0,0,0,0.2);
    opacity: 0;
    transform: translateX(10px);
    transition: opacity 0.3s ease;
    pointer-events: none;
    z-index: 10;
    width: 300px;
}

.tooltip:hover::after {
    opacity: 1;
}

@media (max-width: 768px) {

.pablo span {
    font-size: 20px !important;
}

    body {
        font-size: 16px;
        padding: 10px;
        margin: 0 5px;
    }

    .titu {
        font-size: 28px;
    }

    h1 {
        font-size: 20px;
    }

    h2 {
        font-size: 18px;
    }

    st {
        font-size: 14px;
    }

    .figure img {
        width: 100%;
        height: auto;
    }

    /* Reducci√≥n del tama√±o de im√°genes espec√≠ficas de ecuaciones */
    .figure img[src*="Eq2.png"]{width: 30%;
        height: auto;
    }
    .figure img[src*="Eq2b.png"]{
        width: 35%;
        height: auto;
    }
    .figure img[src*="Eq3.png"]{
        width: 50%;
        height: auto;
    }


    .button-container {
        flex-direction: column;
        gap: 10px;
    }

    .speaker-button {
        font-size: 18px;
    }

    ul {
        margin-left: 15px;
        padding-left: 10px;
    }

    /* Tooltip accesible para m√≥viles */
    .tooltip {
        position: relative;
        display: inline-block;
        cursor: pointer;
    }

    .tooltip::after {
        content: attr(data-tooltip);
        display: block;
        position: static;
        background-color: #eee;
        color: #000;
        padding: 6px 8px;
        border-radius: 5px;
        box-shadow: 0 0 6px rgba(0,0,0,0.2);
        margin-top: 8px;
        font-size: 14px;
        white-space: pre-wrap;
    }
}



.only-desktop { display: inline; }
.only-mobile { display: none; }

@media (max-width: 768px) {
    .only-desktop { display: none; }
    .only-mobile { display: inline; }
}
</style>
</head>
<body>
<div class="titu">Efecto de Batido en Se√±ales sub Nyquist</div>
<div class="titu pablo"><span>Pablo Panitta</span></div>
<h1>Introducci√≥n</h1>
<p> El presente trabajo tiene por objetivo estudiar los efectos en se√±ales cuyas frecuencias est√©n cercanas a la de Nyquist (llamadas sub Nyquist). Comenzaremos analizando la interacci√≥n entre
dos se√±ales anal√≥gicas y los efectos que se presentan. Luego analizaremos lo que ocurre en el √°mbito digital entre una se√±al y su cercan√≠a con la frecuencia de Nyquist. Se abordar√° las
implicancias en la representaci√≥n gr√°fica de las se√±ales y su impacto en la conversi√≥n D/A para su reproducci√≥n.</p>
<h1>1. Suma de dos se√±ales anal√≥gicas</h1>
<p>Supongamos que tenemos 2 se√±ales senoidales anal√≥gicas y las sumamos. ¬øQu√© resultado veremos en la pantalla de un osciloscopio? Si la diferencia entre ambas frecuencias es grande (digamos superior a 10 veces), veremos que la senoidal de mayor frecuencia se encontrar√° superpuesta sobre la de baja frecuencia.</p>
<p>Pero a medida que dicha diferencia de frecuencias se achica, comenzaremos a apreciar cada vez mas, que la senoide de mayor frecuencia se encuentra <strong>‚Äúbatida‚Äù</strong> por la de menor frecuencia.</p>
<p>En las Fig 1, Fig 2, Fig 3 y Fig 4 se pueden apreciar los efectos reci√©n mencionados.</p>
<div class="figure">
<img alt="Dos se√±ales senoidales de 1000Hz y 50 Hz" src="Pictures/fig1.png"/>
<p><st>Fig 1. Dos se√±ales senoidales de 1000Hz y 50 Hz</st></p><br/>
</div>
<div class="figure">
<img alt="Resultado de la suma de 1000Hz y 50Hz" src="Pictures/fig2.png"/>
<p><st>Fig 2. Resultado de la suma de 2 se√±ales senoidales de 1000Hz y 50Hz</st></p><br/>
</div>
<div class="figure">
<img alt="Dos se√±ales senoidales de 1000Hz y 1100Hz" src="Pictures/fig3.png"/>
<p><st>Fig 3. Dos se√±ales senoidales de 1000Hz y 1100Hz</st></p><br/>
</div>
<div class="figure">
<img alt="Resultado de la suma de 1000Hz y 1100Hz" src="Pictures/fig4.png"/>
<p><st>Fig 4. Resultado de la suma de 2 se√±ales senoidales de 1000Hz y 1100Hz</st></p><br/>
</div>
<p>Notar el efecto que tiene la fase en la suma de se√±ales para ambas combinaciones. Mientras la misma no juega un papel importante cuando la diferencia de frecuencias es grande, s√≠ lo hace cuando son frecuencias cercanas, produciendo cancelaciones o refuerzos en la magnitud de la suma.</p>
<p>Observar que la frecuencia de batido es igual a la diferencia de frecuencias entre ambas se√±ales (en este caso 100Hz).<sup><span class="only-desktop"><a class="tooltip" data-tooltip="La frecuencia de batido es la diferencia entre ambas se√±ales. Sin embargo, si pensamos el batido como 2 ondas que se entrelazan, la frecuencia de cada componente es la mitad, o sea, 50Hz para nuestro caso. La aclaraci√≥n tomar√° importancia m√°s adelante cuando comenzaremos a hablar de la frecuencia de cada ‚Äúcomponente‚Äù del batido." href="#nota1">[1]</a></span><span class="only-mobile"><a href="#nota1">[1]</a></span></sup></p>
<p>En ambos casos, en un an√°lisis espectral, ver√© las dos frecuencias senoidales puras y nada m√°s.</p>
<div class="figure">
<img alt="Espectro de se√±ales Escenario1 y Escenario2" src="Pictures/fig5a.png"/>
<img alt="Espectro de se√±ales Escenario1 y Escenario2" src="Pictures/fig5b.png"/>
<p>Fig 5. Espectro de se√±ales a) Escenario1 , b) Escenario2</p>
</div>
<br/>
<h1>3. Batido en √°mbito digital</h1>
<p>Supongamos ahora, que tenemos una se√±al anal√≥gica y procedemos a muestrearla para su digitaci√≥n. A los fines de la demostraci√≥n, tomemos los siguientes valores:</p>
<div class="equation-left">
<p> - Frecuencia de la se√±al: 500 Hz<br/> - Frecuencia de muestreo: 44.1kHz</p>
</div>
<p>En la Fig 6 podemos ver que la se√±al muestreada, se encuentra perfectamente por sobre la se√±al anal√≥gica, no presentando desv√≠os de magnitud.</p>
<div class="figure">
<img alt="Muestreo de se√±al anal√≥gica alej  alejada de Nyquist" src="Pictures/fig7.png"/>
<p><st>Fig 6. Muestreo de se√±al anal√≥gica con frecuencia alejada de la de Nyquist</st></p>
</div>
<p>Repitamos el proceso, pero ahora con una frecuencia cercana a la de muestreo, por ejemplo a una frecuencia de la se√±al: 20 kHz</p>
<div class="figure">
<img alt="Muestreo de se√±al anal√≥gica cercana a Nyquist" src="Pictures/fig8.png"/>
<p><st>Fig 7. Muestreo de se√±al anal√≥gica con frecuencia cercana a Nyquist</st></p>
</div>
<p>En la Fig 7 podemos claramente apreciar un efecto de batido sobre la se√±al de 20kHz. Esto se ve muy parecido al efecto descripto en la secci√≥n anterior con 2 frecuencias anal√≥gicas. Pero si aqu√≠ estamos trabajando solo con 1 frecuencia‚Ä¶ ¬øc√≥mo puede estar ocurriendo esto?</p>
<p>Tratemos de entender qu√© est√° pasando en este caso. Tengo una se√±al anal√≥gica a la entrada de 20kHz que al muestrearla a una tasa de 44.1kHz y que luego, al volver a convertirla a anal√≥gica<sup><span class="only-desktop"><a class="tooltip" data-tooltip="El m√©todo de interpolaci√≥n de Matlab es lineal, y es por ese motivo que vemos trazos rectos uniendo las muestras." href="#nota2">[2]</a></span><span class="only-mobile"><a href="#nota2">[2]</a></span></sup>, se presenta como una se√±al de 20kHz pero modulada en amplitud a 4.1kHz.
    Todo dar√≠a a pensar que, por lo visto anteriormente, deber√≠a existir otra se√±al tal que ‚Äúmodule‚Äù a la de entrada para dar como resultado, la se√±al modulada. Pues confirmemos esto en un analizador de espectro.</p>
<div class="figure">
<img alt="Espectro de se√±al 20kHz muestreada a 44kHz" src="Pictures/fig9.png"/>
<p><st>Fig 8. Espectro de se√±al de 20kHz muestreada a 44kHz</st></p>
</div>
<p>Sin lugar a dudas, la Fig 9 <strong>solo evidencia la existencia de 1 sola se√±al!</strong> Esto no parece tener mucho sentido. Existe una sola se√±al muestreada presente en el espectro pero que, sin embargo, en el dominio del tiempo muestra s√≠ntomas claros de una modulaci√≥n en amplitud (batido) que solo podr√≠an darse cuando existiese otra se√±al interactuando.</p>
<p>¬øY entonces?</p>
<h1>4. Distribuci√≥n de las muestras en una se√±al.</h1>
<p>Supongamos que muestreo una se√±al de frecuencia <em>F</em> a una tasa de muestreo <em>Fs</em>. Si <em>Fs = 2F</em>, tendr√© 2 muestras por ciclo de se√±al, con lo cual no estoy cumpliendo con el teorema de Nyquist, y estar√≠a tendiendo aliasing (un aliasing muy particular porque es DC, o sea 0 Hz).</p>
<div class="figure">
<img alt="Se√±al anal√≥gica muestreada a 2 veces su frecuencia" src="Pictures/fig10.png"/>
<p><st>Fig 9. Una se√±al anal√≥gica muestreada a 2 veces su frecuencia</st></p>
</div>
<p>Si ahora, yo elijo una frecuencia que sea un tercio de la de muestreo <em>Fs = 3F</em>, ver√≠a que existen 3 puntos por ciclo de se√±al y que, adem√°s, ocurren siempre en la misma fase de la se√±al. O sea, se crea un patr√≥n peri√≥dico.</p>
<div class="figure">
<img alt="Se√±al anal√≥gica muestreada a 3 veces su frecuencia" src="Pictures/fig11.png"/>
<p><st>Fig 10. Una se√±al anal√≥gica muestreada a 3 veces su frecuencia. Distribuci√≥n de las muestras e interpolaci√≥n lineal para la reconstrucci√≥n</st></p>
</div>
<p>Y si hici√©semos lo propio, pero ahora con <em>Fs = 5F</em>, habr√≠a 5 muestras por ciclo de se√±al, con las mismas caracter√≠sticas indicadas para la se√±al anterior, como se puede apreciar en la figura de a continuaci√≥n.</p>
<div class="figure">
<img alt="Se√±al anal√≥gica muestreada a 5 veces su frecuencia" src="Pictures/fig12.png"/>
<p><st>Fig 11. Una se√±al anal√≥gica muestreada a 5 veces su frecuencia. Distribuci√≥n de las muestrase interpolaci√≥n lineal para la reconstrucci√≥n</st></p>
</div><br/>
<p>Una particularidad que tienen los ejemplos reci√©n enunciados es que la cantidad de muestras por ciclo de se√±al es invariante. Esto quiere decir que, por ejemplo, en <em>Fs = 3F</em>, existir√°n en cualquier ciclo de la se√±al 3, y solamente 3, muestras. No encontrar√© ciclos en donde existan 2, 4 u otro valor distinto de 3. O sea que existe una relaci√≥n entre <em>F</em> y <em>Fs</em> que la podemos representar por la siguiente ecuaci√≥n:</p>
<div class="figure">
<img src="Pictures/Eq2.png"/><br/>
</div>
<p>Nuevamente, esto significa que, <strong>cada 1 ciclo</strong>, voy a tener ‚Äún‚Äù (2, 3, 4, etc) y <strong>solo ‚Äún‚Äù muestras</strong>. No m√°s, no menos.<br/>Podemos generalizar la f√≥rmula y reescribirla como:</p>
<div class="figure">
<img src="Pictures/Eq2b.png"/><br/>
</div>
<p>Aqu√≠ <i><u>m indica la cantidad de ciclos</u></i> en los cu√°les encontrar√© una cantidad <i><u>n de muestras</u></i>. Por ejemplo si la relaci√≥n fuese 2/5 significar√≠a que en 2 ciclos de la se√±al encontrar√© exactamente a 5 muestras<sup><span class="only-desktop"><a class="tooltip" data-tooltip="Recordar que el valor debe ser siempre m/n &lt; 0.5 para satisfacer el criterio de Nyquist." href="#nota3">[3]</a></span><span class="only-mobile"><a href="#nota3">[3]</a></span></sup>. </p>
<p>Esta caracter√≠stica tiene una consecuencia muy importante y es que, no solo existen la misma cantidad de muestras n en cada m ciclo(s), sino que se adem√°s <strong>se producen en las mismas fases de la se√±al cada m ciclos</strong>. Siguiendo con el ejemplo anterior, las muestras volver√°n a caer en la misma fase de la se√±al cada 2 ciclos.</p>
<p>Pero ¬øa d√≥nde queremos llegar con esto? ¬øQu√© tiene que ver con lo que veo en la pantalla? Un poco m√°s de paciencia que ya estamos m√°s cerca.</p>
<h1>5. Patrones c√≠clicos.</h1>
<p>Adicionemos ahora un √∫ltimo par√°metro a f√≥rmula, llamado Œµ, de manera que resulte como indica la siguiente ecuaci√≥n:</p>
<p>Observemos los gr√°ficos de algunos ejemplos:</p>
<div class="figure">
<img src="Pictures/Eq3.png"/><br/>
</div>
<p>¬øQu√© logro con esta modificaci√≥n? <i><u>Anular la caracter√≠stica de invariabilidad</u></i> de las posiciones de las muestras dentro de ciclo de la se√±al. Aunque seguir√° habiendo una cantidad de n muestras cada m ciclos, la ubicaci√≥n de las mismas dentro de la se√±al ir√° variando.</p>
<p>Y ¬øen alg√∫n momento volver√°n las muestras a caer en la misma fase de la onda? O sea ¬øExistir√° una frecuencia a la cual se repite el ciclo? La respuesta es s√≠, y justamente ese es el valor <span style="font-size: 22px;">Œµ</span>.</p>
<div class="figure">
<img src="Pictures/fig13a.png"/><br/>
<img src="Pictures/fig13b.png"/><br/>
<img src="Pictures/fig13c.png"/><br/>
<p><st>Fig 12. Una se√±al anal√≥gica (amarillo) y sus muestreos a) F = Fs/2 + 20, b) F = Fs/3 + 20, c) F = Fs/5 + 20. Para todos los casos Fs=8 kHz</st></p>
</div>
<p>En la Fig 12 podemos observar la distribuci√≥n de las muestras <strong>‚Äúformando‚Äù ondas senoidales cuya cantidad corresponde con el valor del factor ‚Äú<em>n</em>‚Äù y de una frecuencia de valor <em>Œµ</em></strong>.</p>
<p>O sea, en la f√≥rmula <em>F= Fs/2 - 20</em> se formar√°n 2 ondas, en la <em>Fs/F = Fs/3 - 20</em>, 3 ondas y en la <em>F = Fs/5 - 20</em>, 5 ondas entrelazadas. Todas ellas tienen una frecuencia de 20 Hz (tal como es el valor <em>Œµ</em>).</p>
<p>Notar que estas ondas son productos de una distribuci√≥n gr√°fica las muestras de la se√±al y todas poseen una frecuencia de <em>Œµ</em> Hz. Quiere decir que <em>Œµ</em>, es la <i><u>frecuencia a la cual las muestras vuelven a producirse en la misma fase</u></i> del ciclo de la se√±al. Es f√°cil notar que si Œµ=0, la frecuencia de variaci√≥n es 0 y, por lo tanto, las muestras ocurren siempre en la misma fase de la se√±al.</p>
<h1>6. Proceso de reconstrucci√≥n</h1>
<p>Llama la atenci√≥n el hecho que, si quisiera reconstruir la se√±al a trav√©s de la uni√≥n de las muestras, no estar√≠a obteniendo la misma se√±al original. Tal como se observa en la Fig 13, si aplico el proceso de muestreo a una 
    se√±al senoidal pura (A/D) y luego, a partir de esas muestras, reconstruyo la se√±al (D/A) uniendo las muestras, estar√≠a llegando a una se√±al senoidal pero con batido, lo cual obviamente no es la misma se√±al original. Pero esto es una directa contradicci√≥n con el teorema de Nyquist, el cual afirma que, si cumplo la condici√≥n de muestrear a una tasa superior al doble de la m√°xima frecuencia presente, podr√≠a reconstruir la se√±al original de manera exacta.</p>
<div class="figure">
<img alt="Proceso de reconstrucci√≥n con batido" src="Pictures/fig14.png"/>
<p><st>Fig 13. a) Se√±al anal√≥gica b) Muestras de la se√±al anal√≥gica c) Proceso de reconstrucci√≥n. Se puede observar que a) y c) son distintas</st></p>
</div>
<p>La explicaci√≥n viene por el lado de c√≥mo se realiza la reconstrucci√≥n de la se√±al anal√≥gica a partir de sus muestras. El proceso de interpolaci√≥n consiste en reconstruir el valor de la se√±al entre muestras, y eso <strong>no se logra simplemente ‚Äúuniendo‚Äù las muestras entre s√≠ de manera gr√°fica</strong>. Existen diversas maneras de ‚Äúunir‚Äù (interpolar) gr√°ficamente las muestras. Por ejemplo, una podr√≠a ser la de hacerlo de forma lineal (l√≠nea recta), a trav√©s de un polinomio de orden N (curva), o alg√∫n otro tipo.<sup><span class="only-desktop"><a class="tooltip" data-tooltip="Existen varios m√©todos de interpolaci√≥n como Lagrange (orden N), cubic splines (3er orden), Bezier splines, etc." href="#nota4">[4]</a></span><span class="only-mobile"><a href="#nota4">[4]</a></span></sup><sup><span class="only-desktop"><a class="tooltip" data-tooltip="Algunos softwares permiten elegir el modo gr√°fico de interpolaci√≥n (p.e Ozone RX)" href="#nota5">[5]</a></span><span class="only-mobile"><a href="#nota5">[5]</a></span></sup></p>
<p>Sin embargo, el m√©todo te√≥rico para recuperar totalmente una se√±al anal√≥gica (l√©ase sin p√©rdidas), es a trav√©s de un proceso de convoluci√≥n entre las muestras y la funci√≥n SINC. Est√° totalmente fuera del alcance de este trabajo, explicar detalladamente el proceso de reconstrucci√≥n (interpolaci√≥n), pero lo podemos pensar de la siguiente manera. Si, a una se√±al limitada en frecuencia (y que cumpla con los requerimientos de Nyquist) la quisiera recuperar, podr√≠a filtrarla con un filtro pasa bajo, de manera de quedarme con la banda de frecuencias por debajo de <em>Fs/2</em> y rechazar toda su componente espectral que est√© por arriba de la misma. En la Fig 14 podemos ver el proceso.</p>
<div class="figure">
<img alt="Reconstrucci√≥n en el dominio de la frecuencia" src="Pictures/fig15.png"/>
<p><st>Fig 14. Proceso de reconstrucci√≥n de la se√±al en el dominio de la frecuencia</st></p>
</div>
<p>El mecanismo de este proceso de filtrado, pero visto desde el dominio del tiempo (recordar siempre la dualidad frecuencia ‚Äì tiempo), significar√≠a una convoluci√≥n entre cada una de las muestras y la funci√≥n SINC, que es la representaci√≥n en el tiempo de una respuesta ideal de pasa bajo.</p>
<div class="figure">
<img alt="Reconstrucci√≥n en el dominio del tiempo" src="Pictures/fig16.png"/>
<p><st>Fig 15. Proceso de reconstrucci√≥n de la se√±al en el dominio del tiempo</st></p>
</div>
<p>El problema es que en la teor√≠a este proceso posee una reconstrucci√≥n perfecta, pero en la pr√°ctica no es realizable ya que la funci√≥n SINC se extiende desde -‚àû a +‚àû. Como esto no es posible a los fines pr√°cticos, debemos acotarla temporalmente y aplicarle una ventana. Este recorte temporal de la funci√≥n, tendr√° su impacto en el dominio de la frecuencia en que la respuesta del <u><i>filtro pasa bajo ya no ser√° la ideal y eso traer√° ‚Äúdistorsiones‚Äù en la reconstrucci√≥n de la se√±al anal√≥gica</i></u>. Y son precisamente esos errores lo que hacen que la se√±al reconstruida sea en mayor o menor medida, igual a la original.</p>
<h1>7. ¬øEs real el efecto?</h1>
<p>Habiendo entendido el motivo de las formas ‚Äúraras‚Äù que vemos en la reconstrucci√≥n de determinadas frecuencias, nos cabe preguntarnos si este es un efecto real o es simplemente un efecto visual. La respuesta es que este efecto es tan real como el mismo audio digital, por lo que <strong>no es solamente una percepci√≥n visual, sino tambi√©n auditiva</strong>.</p>
<p>Y comprobar esto no es nada dif√≠cil. Simplemente se puede crear una sesi√≥n en alguna frecuencia de Nyquist que sea audible, generar una se√±al senoidal (o cualquier se√±al peri√≥dica) y escuchar lo que nos devuelve a trav√©s de los parlantes. Por ejemplo, podemos hacer la prueba con una <em>Fs = 8000Hz</em> y con un generador crear senoidales a una <em>F = 3998 Hz y F=3999Hz</em>.</p>
<p>Habiendo llegado hasta aqu√≠ (y ojal√° comprendido la explicaci√≥n) ‚Ä¶ ¬øqu√© esperar√≠as escuchar? (audios de 4 seg, cuidado con el volmen)</p><br/>
<div class="button-container">
<button class="speaker-button" id="playButton1" onclick="playAudio('audioElement1')">üîä F=3998Hz @ Fs=8kHz</button>
<button class="speaker-button" id="playButton2" onclick="playAudio('audioElement2')">üîä F=3999Hz @ Fs=8kHz</button>
</div>
<audio id="audioElement1" preload="auto" src="https://raw.githubusercontent.com/soundinsda/Soundins_website/main/Publications/Sub_Nyquist/Audios/Sine_3998_8k.wav"></audio>
<audio id="audioElement2" preload="auto" src="https://raw.githubusercontent.com/soundinsda/Soundins_website/main/Publications/Sub_Nyquist/Audios/Sine_3999_8k.wav"></audio>
<script>
    const audio1 = document.getElementById("audioElement1");
    const audio2 = document.getElementById("audioElement2");
    const button1 = document.getElementById("playButton1");
    const button2 = document.getElementById("playButton2");

    // Verificar carga del primer audio
    audio1.addEventListener('loadedmetadata', () => {
        console.log("Audio 1 (3998Hz) cargado, duraci√≥n:", audio1.duration, "segundos");
        button1.textContent = "üîä F=3998Hz @ Fs=8kHz";
    });
    audio1.addEventListener('error', (e) => {
        console.error("Error al cargar Audio 1 (3998Hz):", e.message, e);
        button1.textContent = "üîä Error 3998Hz";
    });

    // Verificar carga del segundo audio
    audio2.addEventListener('loadedmetadata', () => {
        console.log("Audio 2 (3999Hz) cargado, duraci√≥n:", audio2.duration, "segundos");
        button2.textContent = "üîä F=3999Hz @ Fs=8kHz ";
    });
    audio2.addEventListener('error', (e) => {
        console.error("Error al cargar Audio 2 (3999Hz):", e.message, e);
        button2.textContent = "üîä Error 3999Hz";
    });

    // Funci√≥n para reproducir
    function playAudio(audioId) {
        const audioPlayer = document.getElementById(audioId);
        if (audioPlayer) {
            audioPlayer.currentTime = 0; // Reinicia el audio al inicio
            audioPlayer.play()
                .then(() => {
                    console.log("Reproduciendo " + audioId);
                })
                .catch(error => {
                    console.error("Error al reproducir " + audioId + ":", error);
                });
        } else {
            console.warn("No se encontr√≥ el audio con ID: " + audioId);
        }
    }

    // Forzar carga expl√≠cita
    audio1.load();
    audio2.load();
</script>
<h1><br/>8. Impacto en el audio digital</h1>
<p>Pero si esto es as√≠‚Ä¶ <i>¬øc√≥mo no es un completo desastre todo lo que escuchamos a trav√©s del audio digital?</i></p>
<p>Bueno, hay que tener en cuenta dos aspectos importantes que se aplican al proceso explicado:</p>
<p> 1) Esto, si bien no es exclusivo, <strong>es  notorio en se√±ales peri√≥dicas</strong>. El efecto de batido, se evidencia al tener repeticiones peri√≥dicas de las muestras en los ciclos de la se√±al (tal como lo explicado en 5).</p>
<p> 2) El efecto es extremadamente notorio en <strong>frecuencias muy pr√≥ximas a Nyquist</strong> y va perdiendo impacto a medida que me alejo de la misma. Si mi frecuencia de Nyquist es de 22050 Hz, <i><u>el efecto empieza a desvanecerse a partir de los 20 kHz hacia abajo</u></i>. O sea, son frecuencias elevadas para una audici√≥n promedio del humano.<sup><span class="only-desktop"><a class="tooltip" data-tooltip="Adicionalmente, el batido es solo percibido si su frecuencia es de muy bajo valor (no m√°s all√° de 15 Hz)." href="#nota6">[6]</a></span><span class="only-mobile"><a href="#nota6">[6]</a></span></sup></p>
<p>En la Fig 16 podemos evidenciar el impacto en relaci√≥n con la frecuencia anal√≥gica a muestrear. A medida que la frecuencia <em>F</em> se aleja de <em>Fs/2</em>, el efecto se va diluyendo (el batido va perdiendo intensidad).</p>
<div class="figure">
<img alt="Batido a distintas frecuencias" src="Pictures/fig17.png"/>
<p><st>Fig 16. Batido a distintas frecuencias. En todos los casos <em>Fs = 8 kHz</em>. Se√±al pico de 1mv</st></p>
</div>
<p>Por estos motivos, aunque resulta curioso verlo en la pantalla de los DAWs, este efecto no resulta ser un problema para el prop√≥sito del audio digital.</p>
<h1>Ap√©ndice I: Mediciones</h1>
<p>A continuaci√≥n se exhiben las mediciones realizadas a la salida de una placa de sonido Marca: Universal Audio - Modelo: Apollo Twin. El instrumento de medici√≥n utilizado fue un Tektronix TBS 1052B, a distintas frecuencias de muestreo y de se√±al.<br/></p>
<p> El proceso de medici√≥n consisti√≥ en generar senoidales a distintas frecuencias y medir la salida de audio anal√≥gica de la placa. Eso es lo que realmente reproducir√°n los parlantes.</p><br/>
<div class="figure">
<img alt="Medici√≥n con Fs=2Hz y F=1Hz" src="Pictures/fig18.png"/>
<p><st>Fig 17. Frecuencia de muestreo <em>Fs = 44100 Hz</em>, Frecuencia de se√±al <em>F = 22049 Hz</em>. Se puede apreciar el <br/>batimento a una frecuencia de 0.5 Hz. Observar que la frecuencia de cada componente es de 1 Hz.<br/><br/></st></p>
</div>
<div class="figure">
<img alt="Medici√≥n con Fs=10Hz y F=5Hz" src="Pictures/fig19.png"/>
<p><st>Fig 18. Frecuencia de muestreo <em>Fs = 44100 Hz</em>, Frecuencia de se√±al <em>F = 22045 Hz</em>. Se puede apreciar el <br/>batimento a una frecuencia de 2.5 Hz. Observar que la frecuencia de cada componente = 5 Hz.<br/><br/></st></p>
</div>
<div class="figure">
<img alt="Medici√≥n con Fs=44100Hz y F=22000Hz" src="Pictures/fig20.png"/>
<p><st>Fig 19. Frecuencia de muestreo <em>Fs = 44100Hz</em>, Frecuencia de se√±al <em>F = 15000Hz</em>. NO se puede apreciar <br/> batimento significativo. Se confirma que alej√°ndose de la frecuencia de Nyquist el efecto de batimento disminuye.<br/><br/></st></p>
</div>
<div class="figure">
<img alt="Comparaci√≥n de impacto a distintas Fs" src="Pictures/fig21a.png"/><br/>
<img alt="Comparaci√≥n de impacto a distintas Fs" src="Pictures/fig21b.png"/><br/>
<p><st>Fig 20. Se√±al F=22049 muestreada a a) Fs=44100 Hz. 
                       b) Fs=88200 Hz. Se puede apreciar el impacto<br/> para una misma frecuencia a distintas frecuencias de muestreo. Para 88100Hz el impacto es <br/>despreciable, mientras que para 44100Hz es notorio.</st></p><br/>
</div>
<h1>Ap√©ndice II: Producto de dos se√±ales anal√≥gicas</h1>
<p>Seg√∫n la identidad trigonom√©trica:</p>
<div class="figure">
<img src="Pictures/Eq1.png"/><br/>
</div>
<p>podemos crear el mismo efecto de batido, pero <i><u>multiplicando se√±ales senoidales</u></i> (en vez de sumarlas) modificando las frecuencias para cumplir con dicha identidad.<sup><span class="only-desktop"><a class="tooltip" data-tooltip="Este es el m√©todo utilizado en el proceso de modulaci√≥n por amplitud (AM). Una se√±al modulante de baja frecuencia (p.e la voz) modula a una portadora (modulada) de bastante mayor frecuencia para su transmisi√≥n." href="#nota7">[7]</a></span><span class="only-mobile"><a href="#nota7">[7]</a></span></sup>  En nuestro ejemplo de A=1000Hz y B=1100Hz, las nuevas frecuencias para lograr el mismo efecto ser√≠an:</p>
<div class="equation-center">
<p>F1 = (A+B)/2 = 1050Hz</p>
<p>F2 = (A-B)/2 = 50Hz</p>
</div>
<div class="figure">
<img alt="Efecto de batido por producto de se√±ales" src="Pictures/fig6.png"/>
<p>Fig 21. Efecto de batido a trav√©s del producto de se√±ales</p>
</div>
<p>Notar que la frecuencia del batido, sigue siendo 50Hz (tal como en el ejemplo de la suma) que es, precisamente, la frecuencia de la moduladora.</p>

<h1>Referencias</h1>
<p id="nota1">[1] La frecuencia de batido es la diferencia entre ambas se√±ales. Sin embargo, si pensamos el batido como 2 ondas que se entrelazan, la frecuencia de cada componente es la mitad, o sea, 50Hz para nuestro caso. La aclaraci√≥n tomar√° importancia m√°s adelante cuando comenzaremos a hablar de la frecuencia de cada ‚Äúcomponente‚Äù del batido.</p>
<p id="nota2">[2] El m√©todo de interpolaci√≥n de Matlab es lineal, y es por ese motivo que vemos trazos rectos uniendo las muestras.</p>
<p id="nota3">[3] Recordar que el valor debe ser siempre m/n &lt; 0.5 para satisfacer el criterio de Nyquist.</p>
<p id="nota4">[4] Existen varios m√©todos de interpolaci√≥n como Lagrange (orden N), cubic splines (3er orden), Bezier splines, etc.</p>
<p id="nota6">[6] Algunos softwares permiten elegir el modo gr√°fico de interpolaci√≥n (p.e Ozone RX)</p>
<p id="nota6">[6] Este es el m√©todo utilizado en el proceso de modulaci√≥n por amplitud (AM). Una se√±al modulante de baja frecuencia (p.e la voz) modula a una portadora (modulada) de bastante mayor frecuencia para su transmisi√≥n. </p>
<h1>Software y Hardware utilizado</h1>
<p>Las simulaciones realizadas en el presente trabajo se han desarrollado en MATLAB‚Ñ¢.</p>
<p>Placa de Sonido Universal Audio, Apollo Twin‚Ñ¢.</p>
<p>Instrumento de medici√≥n Tektronix‚Ñ¢ TBS 1052B.</p>
<h1>Bibliograf√≠a</h1>
<ul>
<li>‚ÄúSub-Nyquist artefacts and sampling moir√© effects‚Äù - Isaac Amidror, Ecole Polytechnique F√©d√©rale de Lausanne (EPFL), Feb.Concurrent2015</li>
<li>‚ÄúAnalyzing the Sampling-Induced Beat Frequency Effect‚Äù - Kerry Schutz ‚Äì Mathwork, Oct 2021</li>
<li>‚ÄúBandlimited Interpolation‚Äù ‚Äì Julius O. Smith III - CCRMA ‚Äì Standford Univ, 2016 May</li>
<li>‚ÄúModern Sampling: A Tutorial‚Äù. Jamie A.S. Angus ‚Äì AES Vol 67, No 5, 2019 May</li><br/>
</ul>
<p><span style="font-size: 24px;">Autor: Pablo Panitta / Soundins</span></p>
</body>
</html>